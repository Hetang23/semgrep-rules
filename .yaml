rules:
- id: default-resteasy-provider-abuse-copy
  severity: WARNING
  languages:
  - java
  metadata:
    cwe: 'CWE-502: Deserialization of Untrusted Data'
    owasp: 'A8: Insecure Deserialization'
    references:
    - https://access.redhat.com/blogs/766093/posts/3162112
    category: security
    technology:
    - jax-rs
    confidence: MEDIUM
    license: Commons Clause License Condition v1.0[LGPL-2.1-only]
  message: When a Restful webservice endpoint isn't configured with a @Consumes annotation,
    an attacker could abuse the SerializableProvider by sending a HTTP Request with
    a Content-Type of application/x-java-serialized-object. The body of that request
    would be processed by the SerializationProvider and could contain a malicious
    payload, which may lead to arbitrary code execution.
  patterns:
  - pattern: |
      @Path("...")
      public $RETURNTYPE $METHOD(...) { ...}
  - pattern-not-inside: |
      @Path("...")
      @Consumes(...)
      public $RETURNTYPE $METHOD(...) { ...}
  - pattern-not-inside: |
      @Path("...")
      @Consumes(...)
      class $CLASSNAME { ...}
